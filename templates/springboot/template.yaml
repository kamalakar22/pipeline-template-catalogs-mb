type: pipeline-template
version: 1

name: Spring Boot Multibranch Pipeline (Maven Only)
description: Multibranch pipeline with feature, PR, and main builds
templateType: MULTIBRANCH

########################################
# ðŸ”¥ REQUIRED: TEMPLATE SELECTORS
########################################
selectors:
  - scm:
      git:
        repoUrl: https://github.com/kamalakar22/board_game.git
        branches:
          include:
            - main
            - feature-.*
            - fix-.*

########################################
# PARAMETERS
########################################
parameters:
  - name: repoUrl
    type: string
    displayName: Repository URL
    defaultValue: https://github.com/kamalakar22/board_game.git

  - name: gitCredentials
    type: credentials
    displayName: Git Credentials

########################################
# MULTIBRANCH CONFIG
########################################
multibranch:
  branchSource:
    git:
      remote: ${repoUrl}
      credentialsId: ${gitCredentials}
      traits:
        # Branch discovery
        - gitBranchDiscovery

        # PR discovery (origin only)
        - changeRequestDiscovery:
            strategyId: 1

        # Cleanup traits
        - cleanBeforeCheckout
        - cleanAfterCheckout
        - localBranch

        # Branch name filter (AFTER selection)
        - headWildcardFilter:
            includes: |
              main
              feature-.*
              fix-.*

  orphanedItemStrategy:
    numToKeep: 10
